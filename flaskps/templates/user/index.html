{% extends "sections_base.html" %}

{% block meta %}
	<meta name="elements" content="{{config.pagination}}">
{% endblock %}

{% block font %}
	<link rel='stylesheet' href='https://use.fontawesome.com/releases/v5.7.0/css/all.css' integrity='sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ' crossorigin='anonymous'>
	<link href="https://fonts.googleapis.com/css?family=Open+Sans:300" rel="stylesheet">
{% endblock %}

{% block style %}
	<link rel="stylesheet" type="text/css" href="{{url_for('static', filename='user/index.css')}}">
	{{ super() }}
{% endblock %}

{% block script %}
	<script src="https://www.solodev.com/assets/pagination/jquery.twbsPagination.js"></script>
	<script src="{{url_for('static', filename='user/search.js')}}"></script>
	<script src="{{url_for('static', filename='user/pager.js')}}"></script>
	<script src="{{url_for('static', filename='user/index.js')}}"></script>
{% endblock %}

{% block content %}
	<div class="row d-flex justify-content-center" id="list-container">
		<div class="col-12">
			<div class="px-0 bg-light rounded rounded-pill shadow-sm col-12 my-2" id="search-container">
				<div class="input-group">
					<input type="search" placeholder="Buscar usuario" class="form-control border-0 rounded-pill rounded" id="search">
					<div class="input-group-append">
						<button class="btn btn-light text-primary rounded-pill" id="search-button"><i class="fa fa-search"></i></button>
					</div>
				</div>
			</div>
			<div class="col-12">
				<small id="result"></small>
			</div>
			<div class="col-12 my-4" id="filters-container">
				<div class="list-subtitle">
					<h5>Filtrar</h5>
				</div>
				<div class="col-10 col-off-2">
					<div class="custom-control custom-checkbox">
						<input type="checkbox" class="custom-control-input" id="active-checkbox">
						<label class="custom-control-label" for="active-checkbox" id="label-user-active">Mostrar s√≥lo usuarios activos</label>
					</div>
				</div>
			</div>
		</div>
		<div class="col-12 table-responsive" id="table-container">
			<table class="table table-hover">
				<thead>
					<tr>
						<th scope="col">Usuario</th>
						<th scope="col">Email</th>
						<th scope="col">Nombres</th>
						<th scope="col">Apellidos</th>
						<th scope="col" class="text-center">
							Activo
						</th>
						<th scope="col" class="text-center">
							Opciones
						</th>
					</tr>
				</thead>
				<tbody>
					{% for user in users %}
						<tr class="user-row">
							<th scope="row" class="username">{{ user.username }}</th>
							<td>{{ user.email }}</td>
							<td class="name">{{ user.first_name }}</td>
							<td class="surname">{{ user.last_name }}</td>
							<td class="text-center">
								<i class="fa fa-{{'check text-success' if (user.is_active) else 'times text-danger'}} user-active" active={{user.is_active|int}}></i>
							</td>
							<td class="text-center">
								<div class="dropdown">
									<button class="white-button btn-sm dropdown-toggle" id="dropdownMenuButton2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
										<i class="fa fa-cog"></i>
									</button>
									<div class="dropdown-menu" aria-labelledby="dropdownMenuButton2">
										<a class="dropdown-item" href="#"><i class="fa fa-user"></i> Ver perfil</a>
										<a class="dropdown-item" href="#"><i class="fa fa-edit"></i> Modificar perfil</a>
										{% if (user.is_active) %}
										<a class="dropdown-item deactivate {{'disabled' if (user.id==current_user.id)}}" href="{{ url_for('deactivate_user', userId=user.id) }}"><i class="fa fa-ban"></i> Deshabilitar usuario</a>
										{% else %}
										<a class="dropdown-item activate {{'disabled' if (user.id==current_user.id)}}" href="{{ url_for('activate_user', userId=user.id) }}"><i class="fa fa-check"></i> Habilitar usuario</a>
										{% endif %}
									</div>
								</div>
							</td>
						</tr>
					{% endfor %}
				</tbody>			
		</table>
	</div>
	<div class="col-12" id="pagination-container">
		<nav class="d-flex justify-content-center">
		<ul class="pagination" id="pagination"></ul>
	</nav>
</div>
</div>
{% endblock %}
